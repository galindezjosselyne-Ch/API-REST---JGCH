# ğŸ§© Fullstack CRUD de Productos (Nuxt 4 + .NET 8)

AplicaciÃ³n fullstack completa que implementa un sistema de gestiÃ³n de productos y ventas con autenticaciÃ³n JWT, subida de imÃ¡genes y reportes CSV. Construida con **.NET 8** (Arquitectura Hexagonal + EF Core SQLite) y **Nuxt 4** (Vue 3 + Nuxt UI).

---

## ğŸš€ TecnologÃ­as principales

- **Backend:** .NET 8, ASP.NET Core Web API, Arquitectura Hexagonal (Ports & Adapters), EF Core (SQLite), JWT Authentication
- **Frontend:** Nuxt 4, Vue 3 Composition API, Nuxt UI, TypeScript
- **Contenedores:** Docker + Docker Compose
- **Base de datos:** SQLite (persistente) / InMemory (opcional para testing)
- **Almacenamiento de imÃ¡genes:** Local (wwwroot/images) / Azure Blob Storage (opcional)
- **DocumentaciÃ³n:** Swagger/OpenAPI
- **Reportes:** ExportaciÃ³n CSV de ventas

---

## ğŸ“‚ Estructura del proyecto

```
ğŸ“¦ josselyne/
â”œâ”€â”€ ProductsApi/                    # Backend (.NET 8)
â”‚   â”œâ”€â”€ Web/                        # Capa de presentaciÃ³n
â”‚   â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthController.cs
â”‚   â”‚   â”‚   â””â”€â”€ ProductsController.cs
â”‚   â”‚   â””â”€â”€ Program.cs
â”‚   â”œâ”€â”€ Application/                # Capa de aplicaciÃ³n
â”‚   â”‚   â”œâ”€â”€ DTOs/
â”‚   â”‚   â”œâ”€â”€ Interfaces/
â”‚   â”‚   â””â”€â”€ Services/
â”‚   â”œâ”€â”€ Domain/                     # Capa de dominio
â”‚   â”‚   â””â”€â”€ Entities/
â”‚   â”œâ”€â”€ Infrastructure/             # Capa de infraestructura
â”‚   â”‚   â”œâ”€â”€ Persistence/
â”‚   â”‚   â”œâ”€â”€ Security/
â”‚   â”‚   â””â”€â”€ Storage/
â”‚   â”œâ”€â”€ Migrations/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ ProductsApi.csproj
â”‚
â”œâ”€â”€ nuxt-app/                       # Frontend (Nuxt 4)
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ index.vue               # Login
â”‚   â”‚   â””â”€â”€ products/
â”‚   â”‚       â””â”€â”€ index.vue           # CRUD + Ventas
â”‚   â”œâ”€â”€ composables/
â”‚   â”‚   â””â”€â”€ useAuth.ts              # AutenticaciÃ³n
â”‚   â”œâ”€â”€ layouts/
â”‚   â”‚   â””â”€â”€ default.vue
â”‚   â”œâ”€â”€ nuxt.config.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ nginx/                          # Reverse proxy
â”œâ”€â”€ docker-compose.yaml
â””â”€â”€ README.MD
```

---

## âš™ï¸ Requisitos previos

Antes de comenzar asegÃºrate de tener instalado:

- [Docker](https://docs.docker.com/get-docker/)
- [Docker Compose](https://docs.docker.com/compose/install/)
- (opcional para desarrollo local)
  - [.NET SDK 8.0](https://dotnet.microsoft.com/en-us/download/dotnet/8.0)
  - [Node.js 18+](https://nodejs.org/)

---

## ğŸ§¾ Variables de entorno

Crea un archivo `.env` en la raÃ­z del proyecto con las siguientes variables:

```bash
# ğŸ” JWT
JWT_SECRET=supersecreto_local_123
JWT_ISSUER=ProductsApi

# â˜ï¸ Azure Blob Storage (opcional)
# Si no tienes cuenta Azure, dÃ©jalo vacÃ­o.
AZURE_BLOB_CONN=DefaultEndpointsProtocol=https;AccountName=...;AccountKey=...;EndpointSuffix=core.windows.net
````

---

## ğŸ‹ CÃ³mo levantar todo con Docker Compose

Desde la raÃ­z del proyecto:

```bash
docker compose up --build
```

Esto levantarÃ¡:

| Servicio              | Puerto local | DescripciÃ³n                          |
| --------------------- | ------------ | ------------------------------------ |
| **Backend (.NET 8)**  | `5000`       | API REST con JWT y CRUD              |
| **Frontend (Nuxt 4)** | `3000`       | Interfaz web con login y CRUD visual |

Cuando todo estÃ© listo:

* Backend: [http://localhost:5000/swagger](http://localhost:5000/swagger)
* Frontend: [http://localhost:3000](http://localhost:3000)

---

## ğŸ” Credenciales de prueba

Por defecto, el backend tiene un usuario **hardcoded** para autenticaciÃ³n:

| Campo      | Valor         |
| ---------- | ------------- |
| Usuario    | `test@local`  |
| ContraseÃ±a | `Password123` |

---

## ğŸ§  Flujo de autenticaciÃ³n

1. **Login**

   * Endpoint: `POST /auth/login`
   * Body:

     ```json
     {
       "username": "test@local",
       "password": "Password123"
     }
     ```
   * Devuelve un `token` JWT vÃ¡lido por 8 horas.

2. **Uso del token**

   * Todas las rutas de productos (`/products`, `/products/{id}`, etc.) requieren el header:

     ```
     Authorization: Bearer <token>
     ```

---

## ğŸ› ï¸ Endpoints principales

### AutenticaciÃ³n
| MÃ©todo   | Ruta             | DescripciÃ³n                                     | Auth |
| -------- | ---------------- | ----------------------------------------------- | ---- |
| `POST`   | `/auth/login`    | Login y obtenciÃ³n del JWT                       | âŒ    |

### Productos
| MÃ©todo   | Ruta             | DescripciÃ³n                                     | Auth |
| -------- | ---------------- | ----------------------------------------------- | ---- |
| `GET`    | `/products`      | Listar productos                                | âœ…    |
| `GET`    | `/products/{id}` | Obtener producto por ID                         | âœ…    |
| `POST`   | `/products`      | Crear producto (multipart/form-data con imagen) | âœ…    |
| `PUT`    | `/products/{id}` | Editar producto                                 | âœ…    |
| `DELETE` | `/products/{id}` | Eliminar producto                               | âœ…    |

### Ventas
| MÃ©todo   | Ruta                      | DescripciÃ³n                          | Auth |
| -------- | ------------------------- | ------------------------------------ | ---- |
| `POST`   | `/products/sales`         | Registrar una venta                  | âœ…    |
| `GET`    | `/products/sales-report`  | Descargar reporte CSV por fechas     | âœ…    |

**Ejemplo de creaciÃ³n de producto con imagen:**

```bash
curl -X POST http://localhost:5000/products \
  -H "Authorization: Bearer <token>" \
  -F "name=Camisa" \
  -F "description=Camisa azul" \
  -F "price=39.99" \
  -F "image=@camisa.jpg"
```

---

## ğŸ’» Desarrollo local (sin Docker)

Si prefieres correr los servicios manualmente:

### Backend

```bash
cd ProductsApi
dotnet restore
dotnet run --project Web
```

Por defecto corre en `http://localhost:5000`.

**Acceder a Swagger**: http://localhost:5000/swagger

### Frontend

```bash
cd nuxt-app
npm install
npm run dev
```

Accede a `http://localhost:3000`.

> AsegÃºrate de que la variable `NUXT_PUBLIC_API_BASE` en `.env.development` apunte a `http://localhost:5000`.

---

## â˜ï¸ ConfiguraciÃ³n opcional de Azure Blob Storage

1. Crea un contenedor en Azure Blob Storage, por ejemplo `product-images`.
2. ObtÃ©n la **connection string** en el portal de Azure (ConfiguraciÃ³n > Claves de acceso).
3. ColÃ³cala en la variable `AZURE_BLOB_CONN` de tu `.env`.
4. Las imÃ¡genes se subirÃ¡n automÃ¡ticamente y la API devolverÃ¡ una `imageUrl` con el enlace pÃºblico al blob.

Si no configuras Azure:

* Las imÃ¡genes se guardarÃ¡n temporalmente en `/tmp`.
* La API devolverÃ¡ una URL `file://` de referencia (suficiente para pruebas locales).

---

## ğŸ§± Persistencia

* La base de datos usa **SQLite** por defecto â†’ los datos **se persisten** en el archivo `products.db`.
* Ideal para desarrollo y producciÃ³n ligera.
* Para usar InMemory (solo testing), cambia en `Web/Program.cs`:

  ```csharp
  builder.Services.AddDbContext<AppDbContext>(options =>
      options.UseInMemoryDatabase("ProductsDb"));
  ```

* Para usar SQL Server:

  ```csharp
  builder.Services.AddDbContext<AppDbContext>(options =>
      options.UseSqlServer(connectionString));
  ```

---

## ğŸ§© Interfaz Frontend

### Login (`/`)

* Formulario de autenticaciÃ³n con validaciÃ³n
* Guarda el token JWT en estado reactivo usando `useState`
* Redirige automÃ¡ticamente a `/products` tras login exitoso
* Manejo de errores de autenticaciÃ³n

### Productos (`/products`)

* **Listar productos**: Grid responsive con cards que muestran imagen, nombre y precio
* **Crear producto**: Formulario con nombre, descripciÃ³n, precio y upload de imagen
* **Eliminar producto**: BotÃ³n de eliminaciÃ³n por producto
* **Comprar producto**: Registra una venta con un clic
* **Descargar reporte**: Genera CSV de ventas filtrado por rango de fechas

### CaracterÃ­sticas UI

* Componentes modernos de **Nuxt UI** (UCard, UButton, UInput, etc.)
* DiseÃ±o responsive con **Tailwind CSS**
* Iconos de **Heroicons**
* OptimizaciÃ³n de imÃ¡genes con **@nuxt/image**
* Auto-redirecciÃ³n al login si el token expira (401/403)

---

## ğŸ§° Comandos Docker Ãºtiles

```bash
# Construir sin levantar
docker compose build

# Levantar (background)
docker compose up -d

# Detener y eliminar contenedores
docker compose down

# Ver logs
docker compose logs -f
```

---

## ğŸ” Rutas rÃ¡pidas

| URL                                                            | DescripciÃ³n                         |
| -------------------------------------------------------------- | ----------------------------------- |
| [http://localhost:5000/swagger](http://localhost:5000/swagger) | DocumentaciÃ³n interactiva de la API |
| [http://localhost:3000](http://localhost:3000)                 | Interfaz web Nuxt                   |

---

## ğŸ§± Licencia

Uso libre para fines educativos, de pruebas o evaluaciÃ³n tÃ©cnica.
DistribuciÃ³n con atribuciÃ³n requerida.